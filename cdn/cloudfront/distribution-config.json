{
  "CallerReference": "legal-ai-system-cdn-2024",
  "Comment": "Legal AI System - Production CDN Distribution",
  "Enabled": true,
  "Origins": {
    "Quantity": 3,
    "Items": [
      {
        "Id": "frontend-origin",
        "DomainName": "legal-ai-frontend.example.com",
        "CustomOriginConfig": {
          "HTTPPort": 80,
          "HTTPSPort": 443,
          "OriginProtocolPolicy": "https-only",
          "OriginSSLProtocols": {
            "Quantity": 1,
            "Items": ["TLSv1.2"]
          },
          "OriginReadTimeout": 30,
          "OriginKeepaliveTimeout": 5
        },
        "ConnectionAttempts": 3,
        "ConnectionTimeout": 10,
        "OriginShield": {
          "Enabled": true,
          "OriginShieldRegion": "us-east-1"
        }
      },
      {
        "Id": "api-origin",
        "DomainName": "legal-ai-api.example.com",
        "CustomOriginConfig": {
          "HTTPPort": 80,
          "HTTPSPort": 443,
          "OriginProtocolPolicy": "https-only",
          "OriginSSLProtocols": {
            "Quantity": 1,
            "Items": ["TLSv1.2"]
          },
          "OriginReadTimeout": 60,
          "OriginKeepaliveTimeout": 5
        },
        "CustomHeaders": {
          "Quantity": 1,
          "Items": [
            {
              "HeaderName": "X-CDN-Secret",
              "HeaderValue": "REPLACE_WITH_SECRET_VALUE"
            }
          ]
        }
      },
      {
        "Id": "s3-static-assets",
        "DomainName": "legal-ai-static.s3.amazonaws.com",
        "S3OriginConfig": {
          "OriginAccessIdentity": "origin-access-identity/cloudfront/REPLACE_WITH_OAI_ID"
        },
        "ConnectionAttempts": 3,
        "ConnectionTimeout": 10
      }
    ]
  },
  "DefaultCacheBehavior": {
    "TargetOriginId": "frontend-origin",
    "ViewerProtocolPolicy": "redirect-to-https",
    "AllowedMethods": {
      "Quantity": 2,
      "Items": ["GET", "HEAD"],
      "CachedMethods": {
        "Quantity": 2,
        "Items": ["GET", "HEAD"]
      }
    },
    "Compress": true,
    "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
    "OriginRequestPolicyId": "88a5eaf4-2fd4-4709-b370-b4c650ea3fcf",
    "ResponseHeadersPolicyId": "CUSTOM_SECURITY_HEADERS_POLICY_ID",
    "SmoothStreaming": false,
    "DefaultTTL": 86400,
    "MinTTL": 0,
    "MaxTTL": 31536000,
    "FunctionAssociations": {
      "Quantity": 1,
      "Items": [
        {
          "FunctionARN": "arn:aws:cloudfront::ACCOUNT_ID:function/security-headers",
          "EventType": "viewer-response"
        }
      ]
    }
  },
  "CacheBehaviors": {
    "Quantity": 6,
    "Items": [
      {
        "PathPattern": "/_next/static/*",
        "TargetOriginId": "frontend-origin",
        "ViewerProtocolPolicy": "redirect-to-https",
        "AllowedMethods": {
          "Quantity": 2,
          "Items": ["GET", "HEAD"]
        },
        "Compress": true,
        "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
        "DefaultTTL": 31536000,
        "MinTTL": 31536000,
        "MaxTTL": 31536000
      },
      {
        "PathPattern": "/static/*",
        "TargetOriginId": "s3-static-assets",
        "ViewerProtocolPolicy": "redirect-to-https",
        "AllowedMethods": {
          "Quantity": 2,
          "Items": ["GET", "HEAD"]
        },
        "Compress": true,
        "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
        "DefaultTTL": 2592000,
        "MinTTL": 86400,
        "MaxTTL": 31536000
      },
      {
        "PathPattern": "/api/*",
        "TargetOriginId": "api-origin",
        "ViewerProtocolPolicy": "https-only",
        "AllowedMethods": {
          "Quantity": 7,
          "Items": ["GET", "HEAD", "OPTIONS", "PUT", "POST", "PATCH", "DELETE"]
        },
        "Compress": true,
        "CachePolicyId": "4135ea2d-6df8-44a3-9df3-4b5a84be39ad",
        "OriginRequestPolicyId": "216adef6-5c7f-47e4-b989-5492eafa07d3",
        "DefaultTTL": 0,
        "MinTTL": 0,
        "MaxTTL": 0
      },
      {
        "PathPattern": "/api/v1/documents/*/view",
        "TargetOriginId": "api-origin",
        "ViewerProtocolPolicy": "https-only",
        "AllowedMethods": {
          "Quantity": 3,
          "Items": ["GET", "HEAD", "OPTIONS"]
        },
        "Compress": true,
        "CachePolicyId": "CUSTOM_API_CACHE_POLICY_ID",
        "DefaultTTL": 300,
        "MinTTL": 60,
        "MaxTTL": 3600
      },
      {
        "PathPattern": "*.jpg",
        "TargetOriginId": "s3-static-assets",
        "ViewerProtocolPolicy": "redirect-to-https",
        "AllowedMethods": {
          "Quantity": 2,
          "Items": ["GET", "HEAD"]
        },
        "Compress": true,
        "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
        "DefaultTTL": 2592000,
        "MinTTL": 2592000,
        "MaxTTL": 31536000
      },
      {
        "PathPattern": "*.woff2",
        "TargetOriginId": "s3-static-assets",
        "ViewerProtocolPolicy": "redirect-to-https",
        "AllowedMethods": {
          "Quantity": 2,
          "Items": ["GET", "HEAD"]
        },
        "Compress": false,
        "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
        "DefaultTTL": 31536000,
        "MinTTL": 31536000,
        "MaxTTL": 31536000,
        "ResponseHeadersPolicyId": "CUSTOM_FONT_HEADERS_POLICY_ID"
      }
    ]
  },
  "CustomErrorResponses": {
    "Quantity": 4,
    "Items": [
      {
        "ErrorCode": 403,
        "ResponsePagePath": "/404.html",
        "ResponseCode": "404",
        "ErrorCachingMinTTL": 300
      },
      {
        "ErrorCode": 404,
        "ResponsePagePath": "/404.html",
        "ResponseCode": "404",
        "ErrorCachingMinTTL": 300
      },
      {
        "ErrorCode": 500,
        "ResponsePagePath": "/500.html",
        "ResponseCode": "500",
        "ErrorCachingMinTTL": 60
      },
      {
        "ErrorCode": 503,
        "ResponsePagePath": "/503.html",
        "ResponseCode": "503",
        "ErrorCachingMinTTL": 10
      }
    ]
  },
  "HttpVersion": "http2and3",
  "IsIPV6Enabled": true,
  "PriceClass": "PriceClass_All",
  "ViewerCertificate": {
    "ACMCertificateArn": "arn:aws:acm:us-east-1:ACCOUNT_ID:certificate/CERTIFICATE_ID",
    "SSLSupportMethod": "sni-only",
    "MinimumProtocolVersion": "TLSv1.2_2021",
    "CertificateSource": "acm"
  },
  "WebACLId": "arn:aws:wafv2:us-east-1:ACCOUNT_ID:global/webacl/legal-ai-waf/WAF_ID",
  "Logging": {
    "Enabled": true,
    "IncludeCookies": false,
    "Bucket": "legal-ai-cloudfront-logs.s3.amazonaws.com",
    "Prefix": "cdn/"
  },
  "DefaultRootObject": "index.html"
}
